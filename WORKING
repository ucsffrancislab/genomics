


20201006-GTEx/20230714-STAR - RUNNING ... After ...
20201006-GTEx/20230*-RMHM
	GTEx viral read count
	tpm over total aligned to virus
	end-to-end, bowtie2 q30, length filter of 50bp RMHM viral

	include body site for sample
 	 sample, site, v1 count, v2 count, v3 count, ...
	sample1, site,        #,        #,        #, ...
	sample2, site,        #,        #,        #, ...
	sample3, site,        #,        #,        #, ...
	sample4, site,        #,        #,        #, ...
	
20201006-GTEx/20230714-Human_Virome_Analysis

20200720-TCGA-GBMLGG-RNA_bam/20230807-cutadapt - RUNNING
20200720-TCGA-GBMLGG-RNA_bam/20230807-STAR-GRCh38 - RUNNING
20200720-TCGA-GBMLGG-RNA_bam/20230807-Human_Virome_Analysis - RUNNING

20230726-Illumina-CystEV/20230809-preprocess
20230726-Illumina-CystEV/20230809-REdiscoverTE
20230726-Illumina-CystEV/20230809-iMOKA







READ "A tissue level atlas of the healthy human virome" https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-020-00785-5 again
	Questions
		What was used to create the values in Table S3. Read count of the respective 39 viral species detected in this study?

READ "Pan-cancer analysis identifies tumor-specific antigens derived from transposable elements" https://www.nature.com/articles/s41588-023-01349-3 
	TEProf2 Questions
		How to convert the TCGA UUIDs to TCGA Barcodes so we can compare the same samples?


Human-Virome
	make blast ref with human, viral, archae and bacteria filtering read names on the fly? aligning with blast will take A VERY LONG TIME.
	Try to create the huge reference with bowtie2, bwa and STAR
	bowtie2 requires too much memory for creation on the cluster.
	/francislab/data1/refs/Human_Virome_Analysis/bwa-index
	Viral discovery - nominate and then align again to all inclusive reference ( hg38 and then RefSeq’s complete )( STAR ? ) 
	(REFERENCE IS HUGE. Making require loads of memory. Using?)





Blood Correction Project
 GTEx Blood for patients with Brain
 Human GTEx Human Virome - process Blood exactly the same as the tissue was
 20201006-GTEx/20230622-RMHMViral/



 
20230726-Illumina-CystEV/
	Let me know when that gets going and we can talk about what to do with the other samples. I think it will be good to just 
	run a general DE analysis on all the CSF samples and the blanks and serum controls.  
	With any luck the SE controls look a bit more consistent this time
	After we have the LGD vs HGD/Invasive Cancer cyst fluid model, take the SE samples that are either LGD or HGD/Invasive 
	Cancer and see if we can predict them with any accuracy.


GBM / LGG / GTEx - Virome Comparison
	Also, no big rush, but could you take a crack at making a table of the viral hits (not antigens) from the TCGA (GBM and LGG) 
	and GTEX brain samples? Not sure the best way to organize it, but i’d like to see if there are any viruses that appear to be 
	more, or less common in TCGA  vs GTEX.

	Yep- unmapped to your masked reference. Then count them up across TCGA and GTEX. If you want to get fancy to to run a t.test 
	between comparign the TCGA  and Gtex, then GBM vs GTEX, then LGG vs GTEX

	Is this to compare to the "A tissue level atlas of the healthy human virome" paper? Should I do what they did instead?

	That would make sense to me to make it directly comparable. The goal is to answer if there are there viral differences 
	between healthy brain and glioma brain? we should know this!

	20200720-TCGA-GBMLGG-RNA_bam/20230531-Viral ???
	20201006-GTEx/20230622-RMHMViral/out-preprocessed-e2e/ ???



Can you also take a couple cracks at normalizing the TCONS virus grouped tables?  Still not sure which is the best way but maybe we should just try a couple?
	no worries- ask Geno for his script (its really just the equation above) implementing this blood adjustment score.  We can then take that and, at an individual level adjust, the viral counts. Then we can re make the summary tables with these new values. IT woudl also be good to run a T.test between the brain sampling sites, by virus- but we can discuss that at the meeting today.
	It would also be great to get started on the DE analysis, but it think looking at the viral counts is the first step.  If we still see differences by virus, especially phage, location that will give us good reason to keep on thsi line of inquiry.


TCGA table - when you have a minute- can you do a test restricting to the same subjects in thr TEprof paper? TEProF2 Pan Cancer
	Would be good to know if we have the figured out
	Awaiting their UUID conversion table


Another idea come up in a meeting today. Remember how we looked for discordant reads (one HERV one human) in DNA WGS data? I’d like to talk about trying to implement that for viruses. Basically looking for viral integration events. Thoughts? Easy to modify HERV script?
	Creating human viral bowtie2, bwa and STAR references
	/francislab/data1/refs/sources/gencodegenes.org/release_43/GRCh38.primary_assembly.genome.plus.viral-20230801
	/francislab/data1/refs/sources/gencodegenes.org/release_43/GRCh38.primary_assembly.genome.plus.viral-20210916-RMHM


 
20200720-TCGA-GBMLGG-RNA_bam/20230628-STAR_hg38_XS/out/*.unmapped.fasta.gz
20201006-GTEx/20230622-RMHMViral preprocessed-end2end DONE - NORMALIZE MATRIX - JOIN WITH SOURCE BODY SITE FOR GROUPING
20201006-GTEx/20230712-STAR - test a few and compare to 20230622-RMHMViral alignments
20201006-GTEx/    Human_Virome_Analysis - DEVELOPING
20200720-TCGA-GBMLGG-RNA_bam/20230712-Human_Virome_Analysis - DEVELOPING - R1 finds few, R2 finds MANY !???


20230426-PanCancerAntigens/20230426-explore - aligned viral proteins to TCONS proteins
20230426-PanCancerAntigens/20230426-explore - merged viral proteins by virus, sum by virus, select only *_tumor "A tissue level atlas of the healthy human virome" - Is this PanCancer or HumanVirome???


20201006-GTEx/20230622-RMHMViral - reproduce paper's results "A tissue level atlas of the healthy human virome" - did section. took forever.
	produce additional masked reference
	what viruses did the authors use? all of them?
	RNA or DNA? Does it matter?
	use blast instead of bowtie2. Is that appropriate for paired end fastq?














--------------------------------------------------

20211111-hg38-viral-homology/ - create blastn masked references "A tissue level atlas of the healthy human virome" - NO
20211111-hg38-viral-homology - use blast to mask instead of bowtie2? - NO

Compare the quality of this CystEV and 20220610-EV  - DONE
	some sort of quality metric
	% cutadapt tossed? - we ran cutadapt differently on these datasets - redid

20230628-Costello/20230706-REdiscoverTE/REdiscoverTE_EdgeR analysis - Spatial so likely very wrong

20230726-Illumina-CystEV/20230801-cutadapt - DONE
20230726-Illumina-CystEV/20230801-STAR - DONE
20230726-Illumina-CystEV/20230801-REdiscoverTE - DONE
20230726-Illumina-CystEV/20230801-iMOKA - DONE
20230726-Illumina-CystEV Create and upload STAR alignment and featurecounts for ALL samples - DONE
20230726-Illumina-CystEV Create and upload REdiscoverTE rollup for ALL samples - DONE

20220804-RaleighLab-RNASeq/20230512-TEProF2 - CREATING VIRAL ANTIGEN TABLE (COLUMN) to add to PanCancer TCONS papers matrix? TRY TO CREATE FOR ALL VIRUSES??

20200720-TCGA-GBMLGG-RNA_bam/20230629-TEProF2 - DONE - CREATE TCONS TABLE (COLUMN) like RaleighLab
20200720-TCGA-GBMLGG-RNA_bam/20230629-TEProF2 - DONE - COMPARE to paper's results table "A tissue level atlas of the healthy human virome" 

20200909-TARGET-ALL-P2-RNA_bam/20230710-TEProF2 - DONE - CREATE TCONS TABLE (COLUMN) like RaleighLab - DONE
20200909-TARGET-ALL-P2-RNA_bam/20230710-TEProF2 - DONE - CREATE TCONS TABLE (COLUMN) like RaleighLab - FOR NOT FOUND IN GTEX

Create CORRECT TCONS TABLE COLUMNS from out/allCandidateStatistics.tsv for all TEProF2 runs ( TCGA, TARGET, RaleighLab, Costello ) - DONE
	20200720-TCGA-GBMLGG-RNA_bam/20230629-TEProF2/subjectsStatistics.presence.???.counts.csv
	20200909-TARGET-ALL-P2-RNA_bam/20230710-TEProF2/subjectsStatistics.presence.ALL.counts.csv
	20220804-RaleighLab-RNASeq/20230512-TEProF2/subjectsStatistics.presence.ALL.counts.csv
	20230628-Costello/20230707-TEProF2/subjectsStatistics.presence.ALL.counts.csv

20200720-TCGA-GBMLGG-RNA_bam/20230628-STAR-TEProF2-test - testing STAR, refs, GTF, XS - TEProF2 - DONE




20230628-Costello/20230629-cutadapt - DONE
20230628-Costello/20230705-STAR - DONE
20230628-Costello/20230706-REdiscoverTE - DONE
20230628-Costello/20230707-TEProF2 - DONE

20230714-Human_Virome_Analysis - Create final table when last sample done - DONE
20230426-PanCancerAntigens/20230426-explore - PHAGE ANALYSIS - DONE
	Can you please make the TCONS/virus grouping table for phages across the TCGA cancers? - DONE

20200720-TCGA-GBMLGG-RNA_bam/20230628-STAR_hg38_XS - DONE
20201006-GTEx/20230622-RMHMViral local DONE??? (This was all reads. Use all in TCGA? Or just STAR unmapped?)
20201006-GTEx/20230622-RMHMViral preprocessed-end2end RUNNING



20201006-GTEx/20230616-PanCancerAntigens-Viral - align samples to viral proteins with blastx (Takes a very very long time) . canceled

20200603-TCGA-GBMLGG-WGS/20230525-MEGAnE - computing AFs for comparison

ll refs/MEGAnE/1000GP.GRCh38_3202.ME_* 
20200603-TCGA-GBMLGG-WGS/20230525-MEGAnE - tumor normal subtraction and comparison to 1GP
20200603-TCGA-GBMLGG-WGS/20230525-MEGAnE/merged_normal_tumor_megane.csv - find most notable
refs/MEGAnE/


working/20220804-RaleighLab-RNASeq/20230518-VCF/merged.vcf.gz - Ginormous



20230217_costello_LG3_exomes_recal/20230613-MEGAnE - WES not supported. Trying so we'll see. FAILED

data/20200603-TCGA-GBMLGG-WGS/20230124-hg38-bwa - vcf prep for something? (latter steps of MEGAnE?)

20210428-EV/20230605-preprocessing
20210428-EV/20230606-iMOKA/
20210428-EV/20230608-iMOKA-raw-untrimmed

20230217_costello_LG3_exomes_recal/20230303-MELT/merged_normal_tumor_melt.csv - find most notable

/francislab/data1/working/20220804-RaleighLab-RNASeq/20230519-Viral
/francislab/data1/working/20200720-TCGA-GBMLGG-RNA_bam/20230531-Viral

/francislab/data1/raw/20230426-PanCancerAntigens

/francislab/data1/working/20220804-RaleighLab-RNASeq/20230512-TEProF2

/francislab/data1/working/20200609_costello_RNAseq_spatial/20230424-TEProF2


/francislab/data1/raw/20220804-RaleighLab-RNASeq/ - featureCounting

Write Paper
/francislab/data1/working/CEPH-ENA-PRJEB3381/20220310-homology


/francislab/data1/refs/sources/hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/latest
hg38.chrXYM_alts.shredded.length200.minlength150.overlap100.noAllNs.hg38.chrXYM_alts.bam
hg38.151.fa
iMOKA on hg38

            811489 francisla  bowtie2   gwendt  R 1-12:25:10      1 c4-n17
            812921 francisla    iMOKA   gwendt PD       0:00      1 (QOSMaxCpuPerUserLimit)
[1]+  Running                 nohup reference2regions.bash &



Unassembled analysis : Trim / filter / Align paired hg38
/francislab/data1/working/20220610-EV/20220624-preprocessing_with_custom_umi_sequence_extraction/pear

/francislab/data1/working/20220610-EV
EV "TestSE" samples ( SFHH011AC SFHH011BB SFHH011BZ SFHH011CH SFHH011I SFHH011S ) (plus 2 random subjects SFHH011Z and SFHH011BO) analysis and comparison 
Group hg38 VCF  Bowtie2 --all
Kmer tables
Simka



Try to do ... but paired. Extract reference or keep as is?
/francislab/data1/working/20220610-EV/20220624-preprocessing_with_custom_umi_sequence_extraction


/francislab/data2/working/20220610-EV
/francislab/data2/working/20220610-EV/20220610-preprocessing - down to 10bp
/francislab/data2/working/20220610-EV/20220610-iMOKA
/francislab/data2/working/20220610-EV/20220614-preprocessing_with_umi - drop range from 5 to say 2
/francislab/data1/working/20220610-EV/20220615-iMOKA
/francislab/data1/working/20220610-EV/20220624-preprocessing_with_custom_umi_sequence_extraction -   RUN IMOKA
/francislab/data1/working/20220610-EV/20220707-REdiscoverTE
/francislab/data1/working/20220610-EV/20220707-iMOKA - predicting based on 20210428-EV/20210706-iMoka models
/francislab/data1/working/20220610-EV/20220707-iMOKA - predicting based on 20210428-EV/20220719-iMoka models

/francislab/data1/working/20210428-EV/20220719-iMOKA - build new model

/francislab/data2/working/20220303-FluPaper/20220707-REdiscoverTE - merge all barcodes for each cell-type for each subject
/francislab/data2/working/20220303-FluPaper/20220527-REdiscoverTE - B15 only
/francislab/data2/working/20220303-FluPaper/20220421-SingleCell

TCGA alignment / TE pipeline testing / Gene count normalization
/francislab/data1/working/20200603-TCGA-GBMLGG-WGS/20220329-hg38
/francislab/data1/working/20200603-TCGA-GBMLGG-WGS/20220405-test-subset-xTea

Alternate TE analyses
Develope singularity containers for each, then test
/francislab/data1/working/20200909-TARGET-ALL-P2-RNA_bam/20220303-TEtranscripts-test
/francislab/data1/working/20200909-TARGET-ALL-P2-RNA_bam/20220302-TEfinder-test
/francislab/data1/working/20200909-TARGET-ALL-P2-RNA_bam/20220302-xTea-test
/francislab/data1/working/20200909-TARGET-ALL-P2-RNA_bam/20220309-SQuIRE-test
/francislab/data1/working/20200909-TARGET-ALL-P2-RNA_bam/20220309-RepEnrich2-test

/francislab/data1/working/20200909-TARGET-ALL-P2-RNA_bam/20220317-TEtools-test




Aggregate k=21 (gonna try AWS) - WAITING ON DECISION
/francislab/data1/working/20200603-TCGA-GBMLGG-WGS/20220121-iMOKA

k=31 - A succeeded. Trying B again. Then C. - WAITING ON COMPLETION
/francislab/data1/working/20200603-TCGA-GBMLGG-WGS/20220121-iMOKA

xTea Demo Test
/francislab/data1/working/CEPH-ENA-PRJEB3381/20220406-xTea-Demo




Rerun with STAR? - Done
/francislab/data1/working/20211111-hg38-viral-homology

Analysis with HeLa cells if we get access
/francislab/data1/working/20211111-hg38-viral-homology

Loosen homology alignment to mask more? Stick with defaults of different aligners
/francislab/data1/working/20211111-hg38-viral-homology

Find discordantly aligned read pairs?
20200720-TCGA-GBMLGG-RNA_bam/20220121-human-viral-chimera

Find discordantly aligned read pairs?
20200909-TARGET-ALL-P2-RNA_bam/20220121-human-viral-chimera

UK Biobank


























/francislab/data2/working/20200720-TCGA-GBMLGG-RNA_bam/20220524-iMOKA

AWS EC2 - S3 running

Rerun with correct BED positions
/francislab/data1/working/20211111-hg38-viral-homology

20200720-TCGA-GBMLGG-RNA_bam/20220121-iMOKA

20200720-TCGA-GBMLGG-RNA_bam/20220103-viral-chimera

20200909-TARGET-ALL-P2-RNA_bam/20220104-viral-chimera

/francislab/data1/raw/20220103-TTMV

kwip - memory hog

HeLa cell line request
~/github/ucsffrancislab/genomics/data/20211207-HeLa

Masking homologous reference regions to minimize ambiguous alignments
20211122-Homology-Paper

20211111-hg38-viral-homology

/francislab/data1/working/20210428-EV/20211117-double_masked_viral

TARGET RNA masked, non-human-homologous alignment (complete genomes or all viral?)
/francislab/data1/working/20200822-TARGET-RNA_fastq/20211115-double_masked_viral/

New EV data
/francislab/data1/working/20211208-EV/20211208-preprocessing
/francislab/data1/working/20211208-EV/20211214-iMOKA

Prepping viral reference
/francislab/data1/working/20211111-hg38-viral-homology
/francislab/data1/working/20211111-hg38-viral-homology/double_masked_viral

MiXCR on TARGET RNA datasets
/francislab/data1/working/20200822-TARGET-RNA_fastq/20211102-mixcr-immunarch
~/github/ucsffrancislab/genomics/data/20200822-TARGET-RNA_fastq/20211102-mixcr-immunarch
Rerunning 3 failed

/francislab/data1/working/20200909-TARGET-ALL-P2-RNA_bam/20211102-mixcr-immunarch
~/github/ucsffrancislab/genomics/data/20200909-TARGET-ALL-P2-RNA_bam/20211102-mixcr-immunarch

Tumor normal difference kmer matrices
2-kupl test run
/francislab/data1/working/20200603-TCGA-GBMLGG-WGS/20211021-2kupl-test/2-kupl/script



--------------------------------------------------



MiXCR on TCGA RNA dataset
/francislab/data1/working/20200720-TCGA-GBMLGG-RNA_bam/20211028-mixcr-immunarch-test
~/github/ucsffrancislab/genomics/data/20200720-TCGA-GBMLGG-RNA_bam/20211028-mixcr-immunarch-test

/francislab/data1/working/20211012-hg38-complete-homology
Jupyter
~/github/ucsffrancislab/genomics/data/20211012-hg38-complete-homology

~/github/ucsffrancislab/genomics/data/20200603-TCGA-GBMLGG-WGS/20201029-hkle-chimera/mateonly
/francislab/data1/working/20200603-TCGA-GBMLGG-WGS/20201029-hkle-chimera/mateonly





????
~/tmp/20210428-EV/20210818-kallisto


/Users/jake/github/ucsffrancislab/genomics/data/20210428-EV/20210909-RetroElement
/francislab/data1/working/20210428-EV/20210909-RetroElement



/francislab/data1/working/20211001-EV/20211021-polyA-test



/francislab/data1/raw/20211001-EV
/francislab/data1/working/20211001-EV/20211003-explore



iMOKA runs
/francislab/data1/working/20200603-TCGA-GBMLGG-WGS/20210923-iMOKA-tumor-normal-test

iMOKA for difference matrices?



