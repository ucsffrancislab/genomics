

#Bootstrap: library
Bootstrap: docker
From: ubuntu:20.04
#GNU bash, version 5.0.17(1)-release (x86_64-pc-linux-gnu)



%runscript

	exec echo "The runscript is the containers default runtime command!"


%files

#	/home/vanessa/Desktop/hello-kitty.txt        # copied to root of container

#	/home/vanessa/Desktop/party_dinosaur.gif     /opt/the-party-dino.gif #


%environment

	VARIABLE=MEATBALLVALUE

	export VARIABLE


%labels

	AUTHOR George.Wendt@ucsf.edu


%post

	#	https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
	export TZ=America/Phoenix
	ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

	apt-get clean all &&
	apt-get -y update &&
	apt-get -y upgrade &&
	apt-get -y install python3-setuptools bash python3 git wget gcc g++ make bzip2 \
		apt-utils default-jre perl python build-essential gcc-multilib  make gcc g++ zlib1g-dev zlib1g unzip zip wget \
		libbz2-dev zlib1g-dev libncurses5-dev libncursesw5-dev liblzma-dev libcurl4-openssl-dev &&
	apt-get -y install r-base=3.4.1 &&
	apt-get -y autoremove

	python3 -m easy_install install pip

	ln -s python3 /usr/bin/python

	python3 -m pip install --upgrade wheel awscli pip numpy scipy sklearn pandas requests seaborn pandoc boto3 pandarallel modin pysam sortedcontainers
		#	scikit-learn==0.18.1

#RUN conda install -c bioconda fastqc=0.11.7
#RUN conda install -c bioconda hisat2=2.1.0
#RUN conda install -c bioconda samtools=1.3.1
#RUN conda install -c bioconda stringtie=1.3.4
#RUN conda install -c bioconda star=2.6.0c
#RUN conda install -c bioconda rsem=1.3.0
#RUN conda install -c conda-forge libiconv=1.15
#RUN conda install -c conda-forge spyder=3.2.8
#RUN conda install -c bioconda trimmomatic=0.36
#RUN conda install -c bioconda java-jdk=8.0.112

	Rscript -e 'install.packages("devtools")'
	Rscript -e 'require(devtools);install_version("devtools", version = "1.13.6")'

	Rscript -e 'require(devtools);install_version("reshape2", version = "1.4.3")'
	Rscript -e 'require(devtools);install_version("ggplot2", version = "3.0.0")'
	Rscript -e 'require(devtools);install_version("gridextra", version = "2.3")'
	Rscript -e 'require(devtools);install_version("gridbase", version = "0.4_7")'
	Rscript -e 'require(devtools);install_version("gtable", version = "0.2.0")'
	Rscript -e 'require(devtools);install_version("rcolorbrewer", version = "1.1_2")'
	Rscript -e 'require(devtools);install_version("gplots", version = "3.0.1")'
	Rscript -e 'require(devtools);install_version("circlize", version = "0.4.4")'
	Rscript -e 'require(devtools);install_version("venndiagram", version = "1.6.20")'
	Rscript -e 'require(devtools);install_version("survival", version = "2.42_6")'
	Rscript -e 'require(devtools);install_version("formula", version = "1.2_3")'
	Rscript -e 'require(devtools);install_version("latticeextra", version = "0.6_28")'
	Rscript -e 'require(devtools);install_version("cluster", version = "2.0.7_1")'
	Rscript -e 'require(devtools);install_version("rpart", version = "4.1_13")'
	Rscript -e 'require(devtools);install_version("nnet", version = "7.3_12")'
	Rscript -e 'require(devtools);install_version("acepack", version = "1.4.1")'
	Rscript -e 'require(devtools);install_version("foreign", version = "0.8_71")'
	Rscript -e 'require(devtools);install_version("data.table", version = "1.11.4")'
	Rscript -e 'require(devtools);install_version("htmltable", version = "1.12")'
	Rscript -e 'require(devtools);install_version("viridislite", version = "0.3.0")'
	Rscript -e 'require(devtools);install_version("htmltools", version = "0.3.6")'
	Rscript -e 'require(devtools);install_version("base64enc", version = "0.1_3")'
	Rscript -e 'require(devtools);install_version("hmisc", version = "4.1_1")'
	Rscript -e 'require(devtools);install_version("knitr", version = "1.20")'
	Rscript -e 'require(devtools);install_version("xlsx", version = "0.6.1")'
	Rscript -e 'require(devtools);install_version("readr", version = "1.1.1")'
	Rscript -e 'require(devtools);install_version("lattice", version = "0.20_35")'
	Rscript -e 'require(devtools);install_version("plyr", version = "1.8.4")'



#	RUN conda install -c bioconda bioconductor-deseq2=1.18.1
#	RUN conda install -c bioconda bioconductor-tximport=1.8.0
#	RUN conda install -c bioconda bioconductor-genomeinfodbdata=1.1.0 
#	RUN conda install -c bioconda bioconductor-complexheatmap=1.18.1


#	RUN    conda install  --override-channels -c iuc -c bioconda -c conda-forge -c defaults -c 

r python=2.7.13 bioconductor-deseq2=1.16.1 r-base=3.4.1 r-pheatmap bioconductor-vsn bioconductor-biocparallel=1.12.0 r-ggrepel star=2.5.3a bedtools=2.25.0 samtools=1.1 stringtie=1.3.3 igvtools=2.3.93 ucsc-genepredtobed ucsc-gtftogenepred ucsc-genepredtogtf ucsc-bedgraphtobigwig r-hexbin

#	RUN	conda create --name squire --override-channels -c iuc -c bioconda -c conda-forge -c defaults -c r python=2.7.13 bioconductor-deseq2=1.16.1 r-base=3.4.1 r-pheatmap bioconductor-vsn bioconductor-biocparallel=1.12.0 r-ggrepel star=2.5.3a bedtools=2.25.0 samtools=1.1 stringtie=1.3.3 igvtools=2.3.93 ucsc-genepredtobed ucsc-gtftogenepred ucsc-genepredtogtf ucsc-bedgraphtobigwig r-hexbin 
#RUN	echo "source activate squire" > ~/.bashrc
 



#ENV PATH /opt/conda/envs/squire/bin:$PATH

RUN	git clone https://github.com/wyang17/SQuIRE 

WORKDIR /SQuIRE
RUN	cd /SQuIRE 
RUN	pip install -e .
#RUN	cd SQuIRE \
#RUN	python setup.py install
RUN	cd /SQuIRE 
RUN	git pull
#ENV PATH /SQuIRE/squire:$PATH
COPY  Count.md.py  /SQuIRE/squire/Count.py

RUN apt-get install -y  --reinstall procps 



	git clone https://github.com/zhongw2/GeneTEFlow.git
	#mv /xTea/bin/* /usr/bin/
	#/bin/rm -rf /xTea


#	singularity run-help xTea.img 
%help

#	singularity remote login --tokenfile ~/sylabs-token 
#	singularity build --remote GeneTEFlow.img GeneTEFlow

	sudo singularity build GeneTEFlow.img GeneTEFlow

