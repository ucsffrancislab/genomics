

cp ../sampleindexes.txt ./umi_indexes.tsv 

./process.bash

./table.bash > results.csv 2> /dev/null 



zcat ../SFSP003_S1_L001_R1_001.fastq.gz | paste - - - - | wc -l
1278406





awk '{print $2}' ../sampleindexes.txt > ../Index1
awk '{print $3}' ../sampleindexes.txt > ../Index2


head ../sampleindexes.txt 
1	GTCAACCA	GCATGCAA
2	TTCTGGTT	AGGCCTTG
3	CCGCAACG	CTCGAACC
4	CTAGGACC	TATATTGA
5	GCATGGTT	AACCAACG
6	AGGCCAAG	GCATTGGT
7	TACGTAGC	CTGAGCAT
8	AGTTATAA	GGTTAGTC
9	TGGCGGTT	AACCGAAC
10	AGCTCCAA	TGGAAGGT

head ../Index1 
GTCAACCA
TTCTGGTT
CCGCAACG
CTAGGACC
GCATGGTT
AGGCCAAG
TACGTAGC
AGTTATAA
TGGCGGTT
AGCTCCAA

head ../Index2
GCATGCAA
AGGCCTTG
CTCGAACC
TATATTGA
AACCAACG
GCATTGGT
CTGAGCAT
GGTTAGTC
AACCGAAC
TGGAAGGT

zcat ../SFSP003_S1_L001_I1_001.fastq.gz | paste - - - - | wc -l
1278406

zcat ../SFSP003_S1_L001_I1_001.fastq.gz | paste - - - - | cut -f2 | head 
GGGCCAAG
CTCATTGC
TATAACTC
TGTGATCC
TATAACTC
TATATAGT
AAGTTCGT
TATAACTC
GTTGCAAC
CATCCTAA

zcat ../SFSP003_S1_L001_I1_001.fastq.gz | paste - - - - | cut -f2 | grep -f ../Index1 | wc -l
1164097


zcat ../SFSP003_S1_L001_I2_001.fastq.gz | paste - - - - | wc -l
1278406

zcat ../SFSP003_S1_L001_I2_001.fastq.gz | paste - - - - | cut -f2 | head
CCAGAAGCGTTGATCAT
GCAGTCCATATTGGCCC
CGTATTGCGCGTTATTT
TCTTTCCCTACACGACG
TCCGTATAACGGGGGGT
AAGAACCAATGTTGTAT
CGACGTAGCAGGCTGAC
AAGAACCAGATAGGTCG
CGCGGTTGATCTGTTCG
AACCTCAGTTATATGCT

zcat ../SFSP003_S1_L001_I2_001.fastq.gz | paste - - - - | cut -f2 | cut -c1-8 | head
CCAGAAGC
GCAGTCCA
CGTATTGC
TCTTTCCC
TCCGTATA
AAGAACCA
CGACGTAG
AAGAACCA
CGCGGTTG
AACCTCAG

zcat ../SFSP003_S1_L001_I2_001.fastq.gz | paste - - - - | cut -f2 | cut -c1-8 | grep -f ../Index1 | wc -l
1154965




awk '{print $2$3}' ../sampleindexes.txt > ../Index12

head ../Index12
GTCAACCAGCATGCAA
TTCTGGTTAGGCCTTG
CCGCAACGCTCGAACC
CTAGGACCTATATTGA
GCATGGTTAACCAACG
AGGCCAAGGCATTGGT
TACGTAGCCTGAGCAT
AGTTATAAGGTTAGTC
TGGCGGTTAACCGAAC
AGCTCCAATGGAAGGT

zcat ../SFSP003_S1_L001_I1_001.fastq.gz | paste - - - - | cut -f2 > ../I1

head ../I1
GGGCCAAG
CTCATTGC
TATAACTC
TGTGATCC
TATAACTC
TATATAGT
AAGTTCGT
TATAACTC
GTTGCAAC
CATCCTAA


zcat ../SFSP003_S1_L001_I2_001.fastq.gz | paste - - - - | cut -f2 | cut -c1-8 > ../I2

head ../I2
CCAGAAGC
GCAGTCCA
CGTATTGC
TCTTTCCC
TCCGTATA
AAGAACCA
CGACGTAG
AAGAACCA
CGCGGTTG
AACCTCAG


paste ../I1 ../I2 | awk '{print $1$2}' > ../I12

head ../I12
GGGCCAAGCCAGAAGC
CTCATTGCGCAGTCCA
TATAACTCCGTATTGC
TGTGATCCTCTTTCCC
TATAACTCTCCGTATA
TATATAGTAAGAACCA
AAGTTCGTCGACGTAG
TATAACTCAAGAACCA
GTTGCAACCGCGGTTG
CATCCTAAAACCTCAG


grep -f ../Index12 ../I12 | wc -l
211679






paste ../I1 ../I2 | sort | uniq -c | sort > ../I1-2.sort.uniq-c.sort

head ../I1-2.sort.uniq-c.sort
      1 AAAAAAAA	AAAAAAAA
      1 AAAAAAAA	AACCGAAC
      1 AAAAAAAA	AGGCCTTG
      1 AAAAAAAA	CGCGACCA
      1 AAAAAAAA	CTGAGCTT
      1 AAAAAAAA	GATCCAAT
      1 AAAAAAAA	GGTAGTTG
      1 AAAAAAAA	TAATGGAT
      1 AAAAAAAA	TCTTTCAC
      1 AAAAAAAA	TTATCGTC

tail ../I1-2.sort.uniq-c.sort
   8795 TTCAAGCC	TTATCGTC
  10217 TTCAAGCC	AACCTCAG
  11035 TTCAAGCC	AACTACCT
  11092 AAGTTCGT	CGACGTAG
  12067 ACTTCGTT	GATCCAAT
  20683 GAGCCTCC	TCGTTCGA
  22839 TGAGGATT	TTATCGTC
  24623 CCTGGTAT	AACTACCT
  28646 CATCCTAA	AACCTCAG
  40612 TTCAAGCC	CGTATTGC


echo -e "Count,Index1,Index2,Index1Sample#,Index2Sample#" > ../CountsIndexesAndSampleNumbers.csv
awk '(NR==FNR){s1[$2]=$1;s2[$3]=$1}(NR!=FNR){ print $1","$2","$3","s1[$2]","s2[$3]}' ../sampleindexes.txt ../I1-2.sort.uniq-c.sort > ../CountsIndexesAndSampleNumbers.csv


head ../CountsIndexesAndSampleNumbers.csv
1,AAAAAAAA,AAAAAAAA,,
1,AAAAAAAA,AACCGAAC,,9
1,AAAAAAAA,AGGCCTTG,,2
1,AAAAAAAA,CGCGACCA,,
1,AAAAAAAA,CTGAGCTT,,
1,AAAAAAAA,GATCCAAT,,27
1,AAAAAAAA,GGTAGTTG,,17
1,AAAAAAAA,TAATGGAT,,
1,AAAAAAAA,TCTTTCAC,,
1,AAAAAAAA,TTATCGTC,,24

tail ../CountsIndexesAndSampleNumbers.csv
8795,TTCAAGCC,TTATCGTC,22,24
10217,TTCAAGCC,AACCTCAG,22,23
11035,TTCAAGCC,AACTACCT,22,21
11092,AAGTTCGT,CGACGTAG,20,20
12067,ACTTCGTT,GATCCAAT,27,27
20683,GAGCCTCC,TCGTTCGA,19,19
22839,TGAGGATT,TTATCGTC,24,24
24623,CCTGGTAT,AACTACCT,21,21
28646,CATCCTAA,AACCTCAG,23,23
40612,TTCAAGCC,CGTATTGC,22,22




