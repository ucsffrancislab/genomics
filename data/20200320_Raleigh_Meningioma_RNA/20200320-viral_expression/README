


Blind RNA viral analysis



kallisto? can't really followup with sleuth without the metadata

diamond doesn't align paired. Not paired data.





hervQuant
RNA-Seq Data
STAR: Simultaneous alignment to hERV and hg19 transcriptome
Total SAM 
Filter: Remove hg19 aligned reads
hERV only SAM 
Salmon: Quantification of hERV expression, normalized to total read count per sample
Expression Matrix
DESeq2 ??? 



STAR to combination of viral and hg38 ?
STAR to just viral?



./pre_process.bash


./process_unpaired.bash

count_fastq_reads.bash *Unmapped.out.R1.fastq.gz

./process_unpaired.bash





merge_summaries.py --int --output unmapped.bam.diamond.viral.summary.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.viral.summary.txt.gz

merge_summaries.py --output unmapped.bam.diamond.viral.summary.normalized.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.viral.summary.normalized.txt.gz

merge_summaries.py --int --output unmapped.bam.diamond.viral.summary.sum-species.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.viral.summary.sum-species.txt.gz

merge_summaries.py --output unmapped.bam.diamond.viral.summary.sum-species.normalized.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.viral.summary.sum-species.normalized.txt.gz

merge_summaries.py --int --output unmapped.bam.diamond.viral.summary.sum-genus.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.viral.summary.sum-genus.txt.gz

merge_summaries.py --output unmapped.bam.diamond.viral.summary.sum-genus.normalized.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.viral.summary.sum-genus.normalized.txt.gz

merge_summaries.py --int --output unmapped.bam.diamond.viral.summary.sum-subfamily.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.viral.summary.sum-subfamily.txt.gz

merge_summaries.py --output unmapped.bam.diamond.viral.summary.sum-subfamily.normalized.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.viral.summary.sum-subfamily.normalized.txt.gz



merge_summaries.py --int --output unmapped.bam.blastn.viral.masked.summary.csv.gz trimmed/*.STAR.hg38.Unmapped.out.blastn.viral.masked.summary.txt.gz

merge_summaries.py --output unmapped.bam.blastn.viral.masked.summary.normalized.csv.gz trimmed/*.STAR.hg38.Unmapped.out.blastn.viral.masked.summary.normalized.txt.gz




merge_summaries.py --int --output unmapped.bam.blastn.viral.masked.summary.sum-species.csv.gz trimmed/*.STAR.hg38.Unmapped.out.blastn.viral.masked.summary.sum-species.txt.gz

merge_summaries.py --output unmapped.bam.blastn.viral.masked.summary.sum-species.normalized.csv.gz trimmed/*.STAR.hg38.Unmapped.out.blastn.viral.masked.summary.sum-species.normalized.txt.gz

merge_summaries.py --int --output unmapped.bam.blastn.viral.masked.summary.sum-genus.csv.gz trimmed/*.STAR.hg38.Unmapped.out.blastn.viral.masked.summary.sum-genus.txt.gz

merge_summaries.py --output unmapped.bam.blastn.viral.masked.summary.sum-genus.normalized.csv.gz trimmed/*.STAR.hg38.Unmapped.out.blastn.viral.masked.summary.sum-genus.normalized.txt.gz






for s in nr.summary nr.summary.sum-species nr.summary.sum-genus ; do
echo $s
merge_summaries.py --int --output unmapped.bam.diamond.${s}.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.${s}.txt.gz
merge_summaries.py --output unmapped.bam.diamond.${s}.normalized.csv.gz trimmed/*.STAR.hg38.Unmapped.out.diamond.${s}.normalized.txt.gz
done



for f in trimmed/???.fastq.gz.read_count.txt; do b=$(basename $f .fastq.gz.read_count.txt); c=$( cat $f ); echo -e $b"\t"$c; done > raw_read_counts.txt

