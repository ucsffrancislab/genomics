


Compare, extract and analyze reads containing several select UMI's.

```BASH
ACCAGTACCGTG,6,22,4,30
ACTGTCATGGTT,19,27,14,20
AGCCACACTGGG,19,34,25,37
AGTAGCTGGTCT,44,123,46,108
GAGTCGTCCTGC,37,61,25,38
TACGGATGAAAG,58,123,28,49
```

```BASH
dir=/francislab/data1/working/20210205-EV_CATS/20210323-preprocessing/output
zcat ${dir}/SFHH001A_S1_L001_R1_001.fastq.gz | paste - - - - | cut -f2 | cut -c1-12 | sort | uniq -c | sort -rn | head
    534 GGAAGAGCACAC
    466 AAAAAAAAAACA
    265 AGATCGGAAGAG
    175 AGTAGCTGGTCT
    141 AGTAAAAAAAAA
    128 TACGGATGAAAG
     93 AGAAAAAAAAAA
     90 CCGTCTGCCTCC
     70 CCGCTTACCTCC
     69 GAGTCGTCCTGC
```

for umi in ACCAGTACCGTG ACTGTCATGGTT AGCCACACTGGG AGTAGCTGGTCT GAGTCGTCCTGC TACGGATGAAAG ; do

```BASH
dir=/francislab/data1/working/20210205-EV_CATS/20210323-preprocessing/output
for umi in GGAAGAGCACAC AGATCGGAAGAG AGTAGCTGGTCT TACGGATGAAAG CCGTCTGCCTCC CCGCTTACCTCC GAGTCGTCCTGC ; do
echo $umi
echo Raw
zgrep -c " ${umi}$" ${dir}/SFHH001A_S1_L001_R1_001.umi.fastq.gz
zgrep -A1 "^@${umi}_" ${dir}/SFHH001A_S1_L001_R1_001.umi.sorted.consolidated.fastq.gz
for trimmer in bbduk1 bbduk2 cutadapt1 cutadapt2 ; do
echo $trimmer
zgrep -A1 "^@${umi}_" ${dir}/SFHH001A_S1_L001_R1_001.umi.sorted.consolidated.${trimmer}.fastq.gz
done
echo
done
```

```BASH
dir=/francislab/data1/working/20210205-EV_CATS/20210323-preprocessing/output
zcat ${dir}/SFHH001A_S1_L001_R1_001.fastq.gz | paste - - - - | cut -f2 | cut -c1-12 | head
```


```BASH
zgrep --no-group-separator -A3 " GAGTCGTCCTGC$" ${dir}/SFHH001A_S1_L001_R1_001.umi.fastq.gz > test.fastq

cat test.fastq | paste - - - - | cut -f2 | cut -c1-100 | sort
GAGTCGTCCTGCAAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTGAAA
GAGTCGTCCTGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTGAAAA
GAGTCGTCCTGCGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTGAAA
GAGTCGTCCTGCGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCAACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTGAAA
GAGTCGTCCTGCGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTGAA
GAGTCGTCCTGCGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTGAA
GAGTCGTCCTGCGCGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTGA
GAGTCGTCCTGCGCGGAAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTT
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAAGATCGGAAGAGCACACGGCTGAACTCCAGTCAAGCCAATATCTCGTATGCCGTCTTCTGCTT
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTT
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTTACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGGAAGAAAAAAAAAAAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCT
GAGTCGTCCTGCGCGGAAGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGC
GAGTCGTCCTGCGCGGAAGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGC
GAGTCGTCCTGCGCGGAAGATAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCT
GAGTCGTCCTGCGCGGAAGATGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTC
GAGTCGTCCTGCGCGGAAGATGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTC
GAGTCGTCCTGCGCGGAAGATGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTC
GAGTCGTCCTGCGCGGAAGATGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTC
GAGTCGTCCTGCGCGGAAGATGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTT
GAGTCGTCCTGCGCGGAAGATGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTT
GAGTCGTCCTGCGCGGAAGATGGAAAAAAAAAACAAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCT
GAGTCGTCCTGCGCGGAAGATGTAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGCCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTT
GAGTCGTCCTGCGCGGAAGATGTAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTT
GAGTCGTCCTGCGCGGAAGATGTAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTT
GAGTCGTCCTGCGCGGAAGATGTAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTT
GAGTCGTCCTGCGCGGAAGATGTAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTT
GAGTCGTCCTGCGCGGAAGATGTAACAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGT
GAGTCGTCCTGCGCGGAAGATGTAACAGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCC
GAGTCGTCCTGCGCGGAAGATGTAACGAAAAAAAAAAACAAAAAAAAAAGATCGGAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCG
GAGTCGTCCTGCGCGGAAGATGTAACGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCC
GAGTCGTCCTGCGCGGAAGATGTAACGGGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTAT
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCCAAAAAAAAAAACAAAAAAAAAAGATCGGAAGCGCACACGTCTGAACTCCAGTCACGCCAATCTCTCGC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAAAAAAAAACAAAAAAAAAAGATCGGAAGACCACACGTCTGAACTCCAGTCACCCCAATATCCCGTA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCT
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCCAAAAAAAAACAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCT
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTAAAGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATACAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATACAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATAAAAAAAAAACAAAAAAAAACGTTCGGAAACCCCACCTTCTGACTCCCCGTCACCCCAA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACAGAAAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCA
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACCAAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACG
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACCAAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACG
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACCGAAAAAAAAAACAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACCGAAGCAAAAAAAAAACAAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAG
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACCGAAGCTGCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACCGAAGCTGCGGATGCGTGCCAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACAC
GAGTCGTCCTGCGCGGAAGATGTAACGGGGCTAAGCTATATACGGAAGCTAAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCA
GAGTCGTCCTGCGCGTAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGCTTG
GAGTCGTCCTGCGCGTAAGAAAAAAAAAACAAAAAAAAAAGATCGGAAGAGCACACGTCTGAACTCCAGTCACGCCAATATCTCGTATGCCGTCTTCTGC


python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.1.fastq 15 0.1
2021-03-24 16:38:48,107 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:38:48,812 - root - INFO - Read 69 input reads
2021-03-24 16:38:48,815 - root - INFO - Wrote 1 consolidated reads to cons.0.1.fastq
2021-03-24 16:38:48,816 - root - INFO - Successfully consolidated 301 bases out of 301 (100.00%)

python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.2.fastq 15 0.2
2021-03-24 16:38:50,478 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:38:51,146 - root - INFO - Read 69 input reads
2021-03-24 16:38:51,155 - root - INFO - Wrote 1 consolidated reads to cons.0.2.fastq
2021-03-24 16:38:51,155 - root - INFO - Successfully consolidated 222 bases out of 301 (73.75%)

python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.3.fastq 15 0.3
2021-03-24 16:38:52,521 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:38:53,090 - root - INFO - Read 69 input reads
2021-03-24 16:38:53,111 - root - INFO - Wrote 1 consolidated reads to cons.0.3.fastq
2021-03-24 16:38:53,111 - root - INFO - Successfully consolidated 147 bases out of 301 (48.84%)

python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.4.fastq 15 0.4
2021-03-24 16:38:54,868 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:38:55,433 - root - INFO - Read 69 input reads
2021-03-24 16:38:55,453 - root - INFO - Wrote 1 consolidated reads to cons.0.4.fastq
2021-03-24 16:38:55,453 - root - INFO - Successfully consolidated 88 bases out of 301 (29.24%)

python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.5.fastq 15 0.5
2021-03-24 16:38:57,284 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:38:57,920 - root - INFO - Read 69 input reads
2021-03-24 16:38:57,927 - root - INFO - Wrote 1 consolidated reads to cons.0.5.fastq
2021-03-24 16:38:57,928 - root - INFO - Successfully consolidated 57 bases out of 301 (18.94%)

python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.6.fastq 15 0.6
2021-03-24 16:38:59,612 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:39:00,264 - root - INFO - Read 69 input reads
2021-03-24 16:39:00,288 - root - INFO - Wrote 1 consolidated reads to cons.0.6.fastq
2021-03-24 16:39:00,288 - root - INFO - Successfully consolidated 41 bases out of 301 (13.62%)

python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.7.fastq 15 0.7
2021-03-24 16:39:02,114 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:39:02,720 - root - INFO - Read 69 input reads
2021-03-24 16:39:02,724 - root - INFO - Wrote 1 consolidated reads to cons.0.7.fastq
2021-03-24 16:39:02,725 - root - INFO - Successfully consolidated 26 bases out of 301 (8.64%)

python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.8.fastq 15 0.8
2021-03-24 16:39:04,765 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:39:05,464 - root - INFO - Read 69 input reads
2021-03-24 16:39:05,466 - root - INFO - Wrote 1 consolidated reads to cons.0.8.fastq
2021-03-24 16:39:05,469 - root - INFO - Successfully consolidated 23 bases out of 301 (7.64%)

python3 ~/github/ucsffrancislab/umi/consolidate.py test.fastq cons.0.9.fastq 15 0.9
2021-03-24 16:39:07,227 - root - INFO - Consolidating reads in test.fastq
2021-03-24 16:39:07,939 - root - INFO - Read 69 input reads
2021-03-24 16:39:07,954 - root - INFO - Wrote 1 consolidated reads to cons.0.9.fastq
2021-03-24 16:39:07,955 - root - INFO - Successfully consolidated 20 bases out of 301 (6.64%)
```


