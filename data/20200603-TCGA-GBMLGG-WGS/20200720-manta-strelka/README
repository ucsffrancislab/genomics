
See /home/gwendt/github/ucsffrancislab/genomics/data/20200529_Raleigh_WES/20200607-manta-strelka/README


./manta_strelka.bash


Filter/select and merge out/*.manta_strelka/strelka/results/variants/somatic.snvs.vcf.gz


mkdir position_analysis
for f in out/*.manta_strelka/strelka/results/variants/somatic.snvs.vcf.gz ; do
sample=${f%.manta_strelka/strelka/results/variants/somatic.snvs.vcf.gz}
sample=$( basename $sample )
echo $sample
bcftools query -f "%CHROM:%POS\n" -i 'TYPE="SNP"' ${f} > position_analysis/${sample}.manta_strelka_positions.SNP.txt
bcftools query -f "%CHROM:%POS\n" -i 'FILTER="PASS" && TYPE="SNP"' ${f} > position_analysis/${sample}.manta_strelka_positions.SNP.PASS.txt
bcftools query -f "%CHROM:%POS\n" -i 'FILTER="PASS" && TYPE="SNP" && MQ>30 && ReadPosRankSum>-10' ${f} > position_analysis/${sample}.manta_strelka_positions.SNP.PASS.30.-10.txt
bcftools query -f "%CHROM:%POS\n" -i 'FILTER="PASS" && TYPE="SNP" && MQ>60 && ReadPosRankSum>-8' ${f} > position_analysis/${sample}.manta_strelka_positions.SNP.PASS.60.-8.txt
bcftools query -f "%CHROM:%POS\n" -i 'FILTER="PASS" && TYPE="SNP" && MQ>40 && ReadPosRankSum>-8' ${f} > position_analysis/${sample}.manta_strelka_positions.SNP.PASS.40.-8.txt
bcftools query -f "%CHROM:%POS\n" -i 'FILTER="PASS" && TYPE="SNP" && MQ>40 && ReadPosRankSum>-4' ${f} > position_analysis/${sample}.manta_strelka_positions.SNP.PASS.40.-4.txt
done


for x in SNP SNP.PASS SNP.PASS.30.-10 SNP.PASS.40.-4 SNP.PASS.40.-8 SNP.PASS.60.-8 ; do
echo $x
./merge_position_lists.py --output mutation_positions.${x}.csv.gz position_analysis/*.manta_strelka_positions.${x}.txt
done














for f in out/*.manta_strelka/strelka/results/variants/somatic.snvs.vcf.gz ; do
sample=${f%.manta_strelka/strelka/results/variants/somatic.snvs.vcf.gz}
sample=$( basename $sample )
echo $f $sample
bcftools query -f "%LINE" -i 'FILTER="PASS" && TYPE="SNP" && MQ>40 && ReadPosRankSum>-8' ${f} | awk -v sample=$sample -f ~/.local/bin/tumor_normal_vcf_prep_for_mutation_signatures.awk
done


Note that TCGA used hg19


~/github/jakewendt/Mutation-Signatures/count_trinuc_muts_v8.pl pvcf /francislab/data1/refs/fasta/Homo_sapiens_assembly19.fasta count_trinuc_input.csv > mut_all_sort.txt







Create a mutations signature notebook to be executed at the command line.
Sadly, this would have to be on my laptop as it doesn't work on the cluster.

simplify and generalize notebook

signature versions need to be rigid given the differences

However, the "mut.txt" and "mut_all_sort.txt" have a fixed structure
so create environment variables for these 2 files.

drop tissue

export environmentVariable1="Some Value"
export environmentVariable2="Some Value"
jupyter_nbconvert.bash --to html --execute --output OUTPUT.html --ExecutePreprocessor.timeout=600 ~/.local/bin/mutation_signatures.ipynb
b="My Analysis Title"
sed -i "s/<title>mutation_signatures<\/title>/<title>${b}<\/title>/" OUTPUT.html
sed -i 's/\(id="notebook-container">\)$/\1<h1 align="center">'${b}'<\/h1>/' OUTPUT.html


head -100 ~/.local/bin/deseq.ipynb
Reproduce-2.v91.v3.empty.ipynb







